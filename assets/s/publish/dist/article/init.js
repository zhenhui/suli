define("sjplus/publish/0.0.1/article/init",["./upload-thumbnails","sea/upload/upload","./editor"],function(a){a("./upload-thumbnails");var b=a("./editor"),c=document.forms.publish;$(c).on("submit",function(a){a.preventDefault(),b&&b.editor&&(c.elements.content.value=b.editor.getData()),$.post("/publish/article/save",$(c).serialize(),function(a){a&&a.docs?window.location.href='/personal#all-works{"view":"article"}':alert("遇到错误:\r\n"+a.err.join("\r\n"))})})}),define("sjplus/publish/0.0.1/article/upload-thumbnails",["sea/upload/upload"],function(a){var b="/publish/article/save-article-banner",c=a("sea/upload/upload"),d=$(".J-thumbnails-status"),e=new c({trigger:"#upload_thumbnails",name:"file",action:b,data:{_csrf:window._csrf_token_}}).change(function(){e.submit()}).success(function(a){try{var b=$.parseJSON(a);b._id&&!b.err?($("#thumbnails_id").val(b._id),d.addClass("text-success").removeClass("text-error").html("上传成功"),$("#thumbnails-preview").attr("src",window.imgCDN+"/read/"+b._id.split(":")[0]).addClass("block")):d.addClass("text-error").removeClass("text-success").html("上传失败："+b.err)}catch(c){alert("服务器出错")}})}),define("sjplus/publish/0.0.1/article/editor",[],function(a,b){KISSY.use("editor, editor/plugin/source-area,editor/plugin/font-size,editor/plugin/heading,editor/plugin/table,editor/plugin/image,editor/plugin/code",function(a,c,d,e,f,g){var h={focused:!0,attachForm:!0,render:"#editorEl",width:"100%",height:"400px"};h.plugins=[d,e,new f({upload:{serverUrl:"http://localhost/kissy_git/kissy/src/editor/demo/upload.php",suffix:"png,jpg,jpeg,gif",fileInput:"Filedata",sizeLimit:1e3,extraHtml:"<p style='margin-top:10px;'><input type='checkbox' id='ke_img_up_watermark_1' checked='checked'> 图片加水印，防止别人盗用</p>"}}),g];var i=new c(h).render();b.editor=i})});
